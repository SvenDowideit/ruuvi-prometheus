# Contributor: Joonas Kuorilehto
# Maintainer:
pkgname=ruuvi-prometheus
pkgver=0.0.1
pkgrel=0
pkgdesc="Ruuvi sensor Prometheus exporter"
url="https://github.com/joneskoo/ruuvi-prometheus"
arch="all"
depends="bluez"
license="BSD-2-Clause"
options="!check"  # No test suite
depends=""
makedepends="go"
install=""
subpackages="$pkgname-openrc"

source="$pkgname-$pkgver.tar.gz::https://github.com/joneskoo/ruuvi-prometheus/archive/v$pkgver.tar.gz
        ruuvi-prometheus.initd
        "
builddir="$srcdir/$pkgname-$pkgver"

build() {
	cd "$builddir"
	go build .
}

package() {
	cd "$builddir"
	install -Dm755 ./ruuvi-prometheus "$pkgdir"/usr/bin/ruuvi-prometheus
	install -Dm755 "$srcdir"/ruuvi-prometheus.initd "$pkgdir"/etc/init.d/ruuvi-prometheus
}

sha512sums="dca8936e100332b5969096d2061cf4d41649bb05a0bf7f0911a17d98a981dbde6beb99f8bd1c968141227523c49ee71cbc16c6c4f393a0aa74563ee3d60ebcad  ruuvi-prometheus-0.0.1.tar.gz
abd6c1450ae72dd7de5be8d5c416f2a8511de3cff6dc35eff7489514088f1af86446e53338328218a6efe89eb731e0de8c8816b98eb73ed2adde3f306f9ab74a  ruuvi-prometheus.initd"

